"""
	Rule to merge several raw read files (fastq format) sharing the same
	sample (GSM identifier).
"""

rule merge_short_reads:
    """Merge the raw short read files (SRR) belonging to the same sample (GSM)"""
    output: CHIP_READ_DIR + "/{gsm}/{gsm}_merged.fastq"
    params: qsub = QSUB_PARAM + " -e " + CHIP_READ_DIR + "/{gsm}/{gsm}_merged_qsub.err -o " + CHIP_READ_DIR + "/{gsm}/{gsm}_merged_qsub.out"
    log: CHIP_READ_DIR + "/{gsm}/{gsm}_merged.log"
    benchmark: CHIP_READ_DIR + "/{gsm}/{gsm}_merged_benchmark.json"
    message: "Merging short reads for sample {input}"
    shell: "ls -1 {wildcards.CHIP_READ_DIR}/{wildcards.gsm}/SRR*.fastq | xargs cat > {output};"
