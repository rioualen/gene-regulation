## TO CHECK: can we suppress this rule which is now in util.rules ?
## It would be useful because in util.py we define ruleorder, to
## ensure that sorting has priority on sam to bam conversion.

## Claire: works for me.

print("convert_sam_to_bam.rules is obsolete, we recommend to use util.rules instead.")

rule sam_to_bam:
	"""    Convert reads from SAM (sequence alignment map) to BAM (binary
	alignment map) format.

	Required parameters:
		config["qsub"]

	Usage: 
		 input:expand('{read_dir}/{sample}_{aligner}.bam', sample=SAMPLES, read_dir=READS, aligner=ALIGNERS)
	"""
	input: "{data}.sam"
	output: "{data}.bam"
	log: "{data}_sam_to_bam.log"
	benchmark: "{data}_sam_to_bam_benchmark.json"
	params: qsub=config["qsub"]+" -e {data}_sam_to_bam_qsub.err -o {data}_sam_to_bam_qsub.out"
	shell: "samtools view -bSh -o {output} {input} 2> {log}"


#	params: qsub=config["qsub"]+" -e {data}_sam_to_bam_qsub.err -o {data}_sam_to_bam_qsub.out"
#		genome= config["bwa"]["index"]
#	shell: "samtools faidx all_sequences.fa; \
#		samtools view -bS -t all_sequences.fai -o {output} {input} 2> {log}"
