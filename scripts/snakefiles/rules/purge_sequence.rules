rule purge_sequence:
	"""Mask redundant fragments in a sequence. This perl script is no
	more than a wrapper to facilitate this specific usage for two
	programs developed by Stefan Kurtz : mkvtree and vmatch.

	Required parameters:
		config["qsub"]

	Usage example: 
		PURGE_SPP_PEAKS = expand(expand(RESULTS_DIR + "{treat}_vs_{ctrl}/spp/{treat}_vs_{ctrl}{{trimming}}_{{aligner}}_spp_purged.fasta", zip, treat=TREATMENT, ctrl=CONTROL), 
			trimming=config["sickle"]["suffix"], aligner=config["bwa"]["suffix"])

	"""
	input: "{seq}.fasta"
	output: "{seq}_purged.fasta"
	benchmark: "{seq}_purge-seq_benchmark.json"
	log: "{seq}_purge-seq.log"
	params:	qsub = config["qsub"] + " -q short -e {seq}_purge_qsub.err -o {seq}_purge_qsub.out"
	shell: "purge-sequence -i {input} -o {output} 2> {log}"
