"""
    =======================================
    Definition of the index rule bam file
    =======================================
"""

rule index_bam:
    input: "{data_dir}/{data_dir}_bowtie2_mm" + config["bowtie2"]["max_mismatches"] + "_sorted_pos.bam"
    output: "{data_dir}/{data_dir}_bowtie2_mm" + config["bowtie2"]["max_mismatches"] + "_sorted_pos.bam.bai"
    log: "{data_dir}/{data_dir}_bowtie2_mm" + config["bowtie2"]["max_mismatches"] + "_sorted_pos_index.log"
    benchmark: "{data_dir}/{data_dir}_bowtie2_mm" + config["bowtie2"]["max_mismatches"] + "_sorted_pos_index_benchmark.json"
    params: qsub = config["qsub"] + " -q long -e {data_dir}/{data_dir}_bowtie2_mm" + config["bowtie2"]["max_mismatches"] + "_sorted_pos_index_qsub.err -o {data_dir}/{data_dir}_bowtie2_mm" + config["bowtie2"]["max_mismatches"] + "_sorted_pos_index_qsub.out"
    shell:"samtools index {input} 2> {log}"
